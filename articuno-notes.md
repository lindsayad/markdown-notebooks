# 1/8/19

Initial condition number for FDP with manual unit scaling: 7.659023580798e+10
Initial condition number for FDP without any scaling: 1.349249207423e+26
Initial condition number for FDP with PETSc scaling: 3.782640170136e+13

`2d-one-spot-scaled-1st-order.i` 24 steps without surface tension:
SMP non-linear iterations: 133
SMP end time: 30.4495
final dt: 0.0593262

FDP non-linear iterations: 129
FDP end time: 31.1251
final dt: .133484

`2d-one-spot-scaled-1st-order.i` 24 steps with surface tension:
FDP non-linear: 143
FDP end time: 21.2793
final dt: .474609

I should run the `2d-one-spot-scaled-2nd-order.i` tests with surface tension and
compare SMP and FDP performance here. I know that it is worse. Combined with the
results for the 1st order case, it's definitely safe to say there is a bug in
the Jacobian somewhere. This is the number one priority for articuno currently.

# 1/9/19

`2d-one-spot-scaled-2nd-order.i` 24 steps with surface tension with dt = 0.5:
FDP:
non-linear: 123
average: 5.125

+----------------+----------------+----------------+----------------+----------------+----------------+
| time           | linear         | nl             | num_dofs       | tot_linear     | tot_nl         |
+----------------+----------------+----------------+----------------+----------------+----------------+
|   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |
|   5.000000e-01 |   3.400000e+01 |   5.000000e+00 |   1.570000e+03 |   3.400000e+01 |   5.000000e+00 |
|   1.000000e+00 |   3.950000e+02 |   6.000000e+00 |   2.376000e+03 |   4.290000e+02 |   1.100000e+01 |
|   1.500000e+00 |   5.390000e+02 |   5.000000e+00 |   2.754000e+03 |   9.680000e+02 |   1.600000e+01 |
|   2.000000e+00 |   3.270000e+02 |   5.000000e+00 |   2.606000e+03 |   1.295000e+03 |   2.100000e+01 |
|   2.500000e+00 |   8.750000e+02 |   5.000000e+00 |   3.006000e+03 |   2.170000e+03 |   2.600000e+01 |
|   3.000000e+00 |   8.770000e+02 |   5.000000e+00 |   3.006000e+03 |   3.047000e+03 |   3.100000e+01 |
|   3.500000e+00 |   3.000000e+02 |   5.000000e+00 |   2.606000e+03 |   3.347000e+03 |   3.600000e+01 |
|   4.000000e+00 |   3.160000e+02 |   5.000000e+00 |   2.480000e+03 |   3.663000e+03 |   4.100000e+01 |
|   4.500000e+00 |   2.900000e+02 |   5.000000e+00 |   2.332000e+03 |   3.953000e+03 |   4.600000e+01 |
|   5.000000e+00 |   3.960000e+02 |   5.000000e+00 |   2.606000e+03 |   4.349000e+03 |   5.100000e+01 |
|   5.500000e+00 |   4.780000e+02 |   5.000000e+00 |   2.606000e+03 |   4.827000e+03 |   5.600000e+01 |
|   6.000000e+00 |   4.780000e+02 |   5.000000e+00 |   2.606000e+03 |   5.305000e+03 |   6.100000e+01 |
|   6.500000e+00 |   4.970000e+02 |   5.000000e+00 |   2.606000e+03 |   5.802000e+03 |   6.600000e+01 |
|   7.000000e+00 |   2.910000e+02 |   5.000000e+00 |   2.436000e+03 |   6.093000e+03 |   7.100000e+01 |
|   7.500000e+00 |   7.000000e+01 |   5.000000e+00 |   2.288000e+03 |   6.163000e+03 |   7.600000e+01 |
|   8.000000e+00 |   7.100000e+01 |   5.000000e+00 |   2.288000e+03 |   6.234000e+03 |   8.100000e+01 |
|   8.500000e+00 |   7.400000e+01 |   5.000000e+00 |   2.288000e+03 |   6.308000e+03 |   8.600000e+01 |
|   9.000000e+00 |   2.640000e+02 |   4.000000e+00 |   2.162000e+03 |   6.572000e+03 |   9.000000e+01 |
|   9.500000e+00 |   8.000000e+01 |   5.000000e+00 |   2.288000e+03 |   6.652000e+03 |   9.500000e+01 |
|   1.000000e+01 |   1.160000e+02 |   6.000000e+00 |   2.162000e+03 |   6.768000e+03 |   1.010000e+02 |
|   1.050000e+01 |   7.500000e+01 |   5.000000e+00 |   2.288000e+03 |   6.843000e+03 |   1.060000e+02 |
|   1.100000e+01 |   8.800000e+01 |   5.000000e+00 |   2.288000e+03 |   6.931000e+03 |   1.110000e+02 |
|   1.150000e+01 |   1.230000e+02 |   6.000000e+00 |   2.288000e+03 |   7.054000e+03 |   1.170000e+02 |
|   1.200000e+01 |   1.520000e+02 |   6.000000e+00 |   2.288000e+03 |   7.206000e+03 |   1.230000e+02 |
+----------------+----------------+----------------+----------------+----------------+----------------+


SMP:
non-linear: 146
average: 6.083

+----------------+----------------+----------------+----------------+----------------+----------------+
| time           | linear         | nl             | num_dofs       | tot_linear     | tot_nl         |
+----------------+----------------+----------------+----------------+----------------+----------------+
|   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |   0.000000e+00 |
|   5.000000e-01 |   3.400000e+01 |   5.000000e+00 |   1.570000e+03 |   3.400000e+01 |   5.000000e+00 |
|   1.000000e+00 |   8.800000e+01 |   6.000000e+00 |   2.376000e+03 |   1.220000e+02 |   1.100000e+01 |
|   1.500000e+00 |   5.380000e+02 |   7.000000e+00 |   2.754000e+03 |   6.600000e+02 |   1.800000e+01 |
|   2.000000e+00 |   3.480000e+02 |   6.000000e+00 |   2.606000e+03 |   1.008000e+03 |   2.400000e+01 |
|   2.500000e+00 |   9.960000e+02 |   6.000000e+00 |   3.006000e+03 |   2.004000e+03 |   3.000000e+01 |
|   3.000000e+00 |   7.670000e+02 |   6.000000e+00 |   3.006000e+03 |   2.771000e+03 |   3.600000e+01 |
|   3.500000e+00 |   2.850000e+02 |   6.000000e+00 |   2.606000e+03 |   3.056000e+03 |   4.200000e+01 |
|   4.000000e+00 |   2.850000e+02 |   6.000000e+00 |   2.480000e+03 |   3.341000e+03 |   4.800000e+01 |
|   4.500000e+00 |   6.750000e+02 |   6.000000e+00 |   2.332000e+03 |   4.016000e+03 |   5.400000e+01 |
|   5.000000e+00 |   2.890000e+02 |   6.000000e+00 |   2.606000e+03 |   4.305000e+03 |   6.000000e+01 |
|   5.500000e+00 |   6.500000e+01 |   5.000000e+00 |   2.606000e+03 |   4.370000e+03 |   6.500000e+01 |
|   6.000000e+00 |   2.930000e+02 |   6.000000e+00 |   2.606000e+03 |   4.663000e+03 |   7.100000e+01 |
|   6.500000e+00 |   2.890000e+02 |   6.000000e+00 |   2.606000e+03 |   4.952000e+03 |   7.700000e+01 |
|   7.000000e+00 |   6.470000e+02 |   7.000000e+00 |   2.436000e+03 |   5.599000e+03 |   8.400000e+01 |
|   7.500000e+00 |   3.070000e+02 |   6.000000e+00 |   2.288000e+03 |   5.906000e+03 |   9.000000e+01 |
|   8.000000e+00 |   5.140000e+02 |   6.000000e+00 |   2.288000e+03 |   6.420000e+03 |   9.600000e+01 |
|   8.500000e+00 |   4.830000e+02 |   7.000000e+00 |   2.288000e+03 |   6.903000e+03 |   1.030000e+02 |
|   9.000000e+00 |   3.700000e+02 |   6.000000e+00 |   2.162000e+03 |   7.273000e+03 |   1.090000e+02 |
|   9.500000e+00 |   5.080000e+02 |   6.000000e+00 |   2.288000e+03 |   7.781000e+03 |   1.150000e+02 |
|   1.000000e+01 |   5.640000e+02 |   6.000000e+00 |   2.162000e+03 |   8.345000e+03 |   1.210000e+02 |
|   1.050000e+01 |   1.270000e+02 |   6.000000e+00 |   2.288000e+03 |   8.472000e+03 |   1.270000e+02 |
|   1.100000e+01 |   8.940000e+02 |   6.000000e+00 |   2.288000e+03 |   9.366000e+03 |   1.330000e+02 |
|   1.150000e+01 |   1.780000e+02 |   7.000000e+00 |   2.288000e+03 |   9.544000e+03 |   1.400000e+02 |
|   1.200000e+01 |   2.220000e+02 |   6.000000e+00 |   2.288000e+03 |   9.766000e+03 |   1.460000e+02 |
+----------------+----------------+----------------+----------------+----------------+----------------+

SMP without `-snes_test_jacobian`
Time step 1:
 0 Nonlinear |R| = 2.045162e+00
 1 Nonlinear |R| = 2.558662e-01
 2 Nonlinear |R| = 2.897727e-03
 3 Nonlinear |R| = 3.274279e-06
 4 Nonlinear |R| = 3.927878e-06
 5 Nonlinear |R| = 4.940509e-09

Time step 2:
 0 Nonlinear |R| = 1.209805e+00
 1 Nonlinear |R| = 1.500969e-01
 2 Nonlinear |R| = 1.596502e-03
 3 Nonlinear |R| = 7.866464e-06
 4 Nonlinear |R| = 4.537711e-07
 5 Nonlinear |R| = 4.279611e-08
 6 Nonlinear |R| = 1.204773e-08

Time step 3:
 0 Nonlinear |R| = 1.003367e+00
 1 Nonlinear |R| = 4.986025e-02
 2 Nonlinear |R| = 1.491700e-04
 3 Nonlinear |R| = 1.971813e-06
 4 Nonlinear |R| = 3.354487e-07
 5 Nonlinear |R| = 1.362344e-07
 6 Nonlinear |R| = 1.580428e-08
 7 Nonlinear |R| = 1.476796e-10

SMP with `-snes_test_jacobian`
Time step 1:
 0 Nonlinear |R| = 2.045162e+00
 1 Nonlinear |R| = 2.558662e-01
 2 Nonlinear |R| = 2.897727e-03
 3 Nonlinear |R| = 3.274279e-06
 4 Nonlinear |R| = 3.927878e-06
 5 Nonlinear |R| = 4.940509e-09

Time step 2:
 0 Nonlinear |R| = 1.209805e+00
 1 Nonlinear |R| = 1.500969e-01

There are problems with the Jacobians of the following objects:
INSADMomentumBase
VaporRecoilPressureMomentumFluxBC
INSADTemperature
Diffusion?!

# 1/10/19

J0 before pspg = -0.1028233097146113
J0 after pspg = -0.34119633737166605

Un-perturbed r before pspg: -0.023100118036273102
Un-perturbed r after pspg: -0.035276505334731589
Perturbed r before pspg: -0.023100118489841968
Perturbed r after pspg: -0.035276506015831308
dx = 0.0000000044111480962003945
wscale = 226698351.13025662

hand-coded tau derivative vector:
    _data = {
      [0] = 0
      [1] = 0.0040457119239146293
      [2] = 0
      [3] = -0.0040457119239146293
      [4] = 0
      [5] = 0
      [6] = 0
      [7] = 0
      [8] = 0
      [9] = 0
      [10] = -0.0044662577028824289
      [11] = 0
      [12] = 0.0044662577028824289
      [13] = 0
      [14] = 0
      [15] = 0
      [16] = 0
      [17] = 0
      [18] = 0
      [19] = 0
      [20] = 0
      [21] = 0
      [22] = 0
      [23] = 0
      [24] = 0
      [25] = 0
      [26] = 0
      [27] = -0.000000013956448103593122
      [28] = 0.0000000017727013369482402
      [29] = -0.00000000022516259199280381
      [30] = 0.0000000017727013369482402
      [31] = -0.0000000081224978444299185
      [32] = 0.0000000010316924966369574
      [33] = 0.0000000010316924966369574
      [34] = -0.0000000081224978444299185
      [35] = -0.0000000047272035651953048
      [36] = -0.000000013956448103593122
      [37] = 0.0000000017727013369482402
      [38] = -0.00000000022516259199280381
      [39] = 0.0000000017727013369482402
      [40] = -0.0000000081224978444299185
      [41] = 0.0000000010316924966369574
      [42] = 0.0000000010316924966369574
      [43] = -0.0000000081224978444299185
      [44] = -0.0000000047272035651953048
      [45] = 0
      [46] = 0
      [47] = 0
      [48] = 0
      [49] = 0
      [50] = 0
      [51] = 0
      [52] = 0
      [53] = 0

Unperturbed tau:       0.0042666899670282879
Perturbed tau (0 dof): 0.0042666899670282879
Perturbed tau (1 dof): 0.0042666899670282879
Perturbed tau (2 dof): 0.0042666899848745202

0 and 2:
  _val = 1.8119890357784916
  _deriv = {
    _data = {
      [0] = -1.9036748859920865
      [1] = 0
      [2] = 1.9036748859920865
      [3] = 0
      [4] = 0
      [5] = 0
      [6] = 0
      [7] = 0
      [8] = 0
      [9] = -1.9036748859920865
      [10] = 0
      [11] = 1.9036748859920865
      [12] = 0
      [13] = 0
      [14] = 0
      [15] = 0
      [16] = 0
      [17] = 0
      [18] = 0
      [19] = 0
      [20] = 0
      [21] = 0
      [22] = 0
      [23] = 0
      [24] = 0
      [25] = 0
      [26] = 0
      [27] = 0
      [28] = 0
      [29] = 0
      [30] = 0
      [31] = 0
      [32] = 0
      [33] = 0
      [34] = 0
      [35] = 0
      [36] = 0
      [37] = 0
      [38] = 0
      [39] = 0
      [40] = 0
      [41] = 0
      [42] = 0
      [43] = 0
      [44] = 0
      [45] = 0
      [46] = 0
      [47] = 0
      [48] = 0
      [49] = 0
      [50] = 0
      [51] = 0
      [52] = 0
      [53] = 0
    }
  }
}

1 and 3:
  _val = 2.0048819847868922
  _deriv = {
    _data = {
      [0] = 0
      [1] = 1.9011871993424758
      [2] = 0
      [3] = -1.9011871993424758
      [4] = 0
      [5] = 0
      [6] = 0
      [7] = 0
      [8] = 0
      [9] = 0
      [10] = -2.0988128006575244
      [11] = 0
      [12] = 2.0988128006575244
      [13] = 0
      [14] = 0
      [15] = 0
      [16] = 0
      [17] = 0
      [18] = 0
      [19] = 0
      [20] = 0
      [21] = 0
      [22] = 0
      [23] = 0
      [24] = 0
      [25] = 0
      [26] = 0
      [27] = 0
      [28] = 0
      [29] = 0
      [30] = 0
      [31] = 0
      [32] = 0
      [33] = 0
      [34] = 0
      [35] = 0
      [36] = 0
      [37] = 0
      [38] = 0
      [39] = 0
      [40] = 0
      [41] = 0
      [42] = 0
      [43] = 0
      [44] = 0
      [45] = 0
      [46] = 0
      [47] = 0
      [48] = 0
      [49] = 0
      [50] = 0
      [51] = 0
      [52] = 0
      [53] = 0
    }
  }
}

Hand-coded hmax derivative vector:
  _val = 1.4159385526169179
  _deriv = {
    _data = {
      [0] = 0
      [1] = 0.67135229697246679
      [2] = 0
      [3] = -0.67135229697246679
      [4] = 0
      [5] = 0
      [6] = 0
      [7] = 0
      [8] = 0
      [9] = 0
      [10] = -0.74113837665431448
      [11] = 0
      [12] = 0.74113837665431448
      [13] = 0
      [14] = 0
      [15] = 0
      [16] = 0
      [17] = 0
      [18] = 0
      [19] = 0
      [20] = 0
      [21] = 0
      [22] = 0
      [23] = 0
      [24] = 0
      [25] = 0
      [26] = 0
      [27] = 0
      [28] = 0
      [29] = 0
      [30] = 0
      [31] = 0
      [32] = 0
      [33] = 0
      [34] = 0
      [35] = 0
      [36] = 0
      [37] = 0
      [38] = 0
      [39] = 0
      [40] = 0
      [41] = 0
      [42] = 0
      [43] = 0
      [44] = 0
      [45] = 0
      [46] = 0
      [47] = 0
      [48] = 0
      [49] = 0
      [50] = 0
      [51] = 0
      [52] = 0
      [53] = 0
    }
  }
}

uh =  1.4159385526169179
ph0 = 1.4159385526169179
ph1 = 1.4159385526169179
ph2 = 1.4159385555783521
ph3 = 1.4159385493476466

(const std::__1::vector<std::__1::vector<double, std::__1::allocator<double> >, std::__1::allocator<std::__1::vector<double, std::__1::allocator<double> > > >) $10 = size=4 {
  [0] = size=9 {
    [0] = -0.44364916731037085
    [1] = -0.44364916731037085
    [2] = -0.44364916731037085
    [3] = -0.25
    [4] = -0.25
    [5] = -0.25
    [6] = -0.056350832689629149
    [7] = -0.056350832689629149
    [8] = -0.056350832689629149
  }
  [1] = size=9 {
    [0] = 0.44364916731037085
    [1] = 0.44364916731037085
    [2] = 0.44364916731037085
    [3] = 0.25
    [4] = 0.25
    [5] = 0.25
    [6] = 0.056350832689629149
    [7] = 0.056350832689629149
    [8] = 0.056350832689629149
  }
  [2] = size=9 {
    [0] = 0.056350832689629149
    [1] = 0.056350832689629149
    [2] = 0.056350832689629149
    [3] = 0.25
    [4] = 0.25
    [5] = 0.25
    [6] = 0.44364916731037085
    [7] = 0.44364916731037085
    [8] = 0.44364916731037085
  }
  [3] = size=9 {
    [0] = -0.056350832689629149
    [1] = -0.056350832689629149
    [2] = -0.056350832689629149
    [3] = -0.25
    [4] = -0.25
    [5] = -0.25
    [6] = -0.44364916731037085
    [7] = -0.44364916731037085
    [8] = -0.44364916731037085
  }
}
(lldb) p dxidx_map
(const std::__1::vector<double, std::__1::allocator<double> >) $11 = size=9 {
  [0] = 2.0000000000000004
  [1] = 2.0000000000000004
  [2] = 2.0000000000000004
  [3] = 2.0000000000000004
  [4] = 2.0000000000000004
  [5] = 2.0000000000000004
  [6] = 2.0000000000000004
  [7] = 2.0000000000000004
  [8] = 2.0000000000000004
}

unperturbed grad_p:
    _coords = ([0] = -2.5595849771918413, [1] = -0.8487739338190563, [2] = 0)

p0 grad_p:
    _coords = ([0] = -2.5595849954546273, [1] = -0.84877395395934019, [2] = 0)

(lldb) p *_grad_phi._data
(std::__1::vector<libMesh::VectorValue<double>, std::__1::allocator<libMesh::VectorValue<double> > >) $28 = size=9 {
  [0] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.81915754544840891, [1] = -0.90337068833016576, [2] = -0)
    }
  }
  [1] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.9646012354301059, [1] = -0.56358325462549375, [2] = -0)
    }
  }
  [2] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -1.0257955162894301, [1] = 0.041648780666550769, [2] = -0)
    }
  }
  [3] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.5343952800695736, [1] = -0.91899713494543888, [2] = -0)
    }
  }
  [4] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.49798608416869583, [1] = -0.5001551914203568, [2] = -0)
    }
  }
  [5] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.48383789907590813, [1] = -0.099613601865757226, [2] = -0)
    }
  }
  [6] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.034492784393940351, [1] = -0.92002863795075962, [2] = -0)
    }
  }
  [7] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.11645644887202002, [1] = -0.47555234949586117, [2] = -0)
    }
  }
  [8] = {
    libMesh::TypeVector<double> = {
      _coords = ([0] = -0.1395827843649004, [1] = -0.14451254348826201, [2] = -0)
    }
  }
}

(lldb) p *_ad_grad_phi._data
(std::__1::vector<libMesh::VectorValue<MetaPhysicL::DualNumber<double, MetaPhysicL::NumberArray<54, double> > >, std::__1::allocator<libMesh::VectorValue<MetaPhysicL::DualNumber<double, MetaPhysicL::NumberArray<54, double> > > > >) $29 = size=9 {
  [0] = {
    libMesh::TypeVector<MetaPhysicL::DualNumber<double, MetaPhysicL::NumberArray<54, double> > > = {
      _coords = {
        [0] = {
          _val = -1.6175057608264574
          _deriv = {
            _data = {
              [0] = -2.6163248863067765
              [1] = -0.60092132749278993
              [2] = 0.071593702920021693
              [3] = 0.3695821290030849
              [4] = 3.3755736240163547
              [5] = -0.32488600971461395
              [6] = -0.40706607740677525
              [7] = -1.7182647429361473
              [8] = 1.85071358791764
              [9] = -2.8852950529125669
              [10] = -0.66269878885419786
              [11] = 0.078953863083275149
              [12] = 0.40757686250608055
              [13] = 3.7225980340174489
              [14] = -0.3582857776938056
              [15] = -0.44891433227477873
              [16] = -1.8949102186563942
              [17] = 2.0409754107849394
              [18] = 0
              [19] = 0
              [20] = 0
              [21] = 0
              [22] = 0
              [23] = 0
              [24] = 0
              [25] = 0
              [26] = 0
              [27] = 0
              [28] = 0
              [29] = 0
              [30] = 0
              [31] = 0
              [32] = 0
              [33] = 0
              [34] = 0
              [35] = 0
              [36] = 0
              [37] = 0
              [38] = 0
              [39] = 0
              [40] = 0
              [41] = 0
              [42] = 0
              [43] = 0
              [44] = 0
              [45] = 0
              [46] = 0
              [47] = 0
              [48] = 0
              [49] = 0
              [50] = 0
              [51] = 0
              [52] = 0
              [53] = 0
            }
          }
        }
        [1] = {
          _val = -1.7837927522671315
          _deriv = {
            _data = {
              [0] = -2.8852950529125674
              [1] = 0.35769076507387798
              [2] = 0.078953863083275136
              [3] = -0.61281269142199546
              [4] = -1.6330752757957221
              [5] = -0.44469008883037253
              [6] = -0.36251002113821146
              [7] = 3.4607630911567751
              [8] = 2.0409754107849398
              [9] = -3.1819165830407479
              [10] = 0.39446301196829325
              [11] = 0.087070681380125345
              [12] = -0.67581263939198633
              [13] = -1.8009628845974817
              [14] = -0.49040626418254346
              [15] = -0.39977770960157005
              [16] = 3.8165453680763681
              [17] = 2.2507970193895441
              [18] = 0
              [19] = 0
              [20] = 0
              [21] = 0
              [22] = 0
              [23] = 0
              [24] = 0
              [25] = 0
              [26] = 0
              [27] = 0
              [28] = 0
              [29] = 0
              [30] = 0
              [31] = 0
              [32] = 0
              [33] = 0
              [34] = 0
              [35] = 0
              [36] = 0
              [37] = 0
              [38] = 0
              [39] = 0
              [40] = 0
              [41] = 0
              [42] = 0
              [43] = 0
              [44] = 0
              [45] = 0
              [46] = 0
              [47] = 0
              [48] = 0
              [49] = 0
              [50] = 0
              [51] = 0
              [52] = 0
              [53] = 0
            }
          }
        }
        [2] = {
          _val = -0
          _deriv = {
            _data = {
              [0] = 0
              [1] = 0
              [2] = 0
              [3] = 0
              [4] = 0
              [5] = 0
              [6] = 0
              [7] = 0
              [8] = 0
              [9] = 0
              [10] = 0
              [11] = 0
              [12] = 0
              [13] = 0
              [14] = 0
              [15] = 0
              [16] = 0
              [17] = 0
              [18] = 0
              [19] = 0
              [20] = 0
              [21] = 0
              [22] = 0
              [23] = 0
              [24] = 0
              [25] = 0
              [26] = 0
              [27] = 0
              [28] = 0
              [29] = 0
              [30] = 0
              [31] = 0
              [32] = 0
              [33] = 0
              [34] = 0
              [35] = 0
              [36] = 0
              [37] = 0
              [38] = 0
              [39] = 0
              [40] = 0
              [41] = 0
              [42] = 0
              [43] = 0
              [44] = 0
              [45] = 0
              [46] = 0
              [47] = 0
              [48] = 0
              [49] = 0
              [50] = 0
              [51] = 0
              [52] = 0
              [53] = 0
            }
          }
        }
      }
    }
  }

So _grad_phi vs _ad_grad_phi is clearly terribly wrong!

FEProblemBase:
(lldb) p dxidx_map
(const std::__1::vector<double, std::__1::allocator<double> >) $11 = size=9 {
  [0] = 2.0000000000000004
  [1] = 2.0000000000000004
  [2] = 2.0000000000000004
  [3] = 2.0000000000000004
  [4] = 2.0000000000000004
  [5] = 2.0000000000000004
  [6] = 2.0000000000000004
  [7] = 2.0000000000000004
  [8] = 2.0000000000000004
}

DisplacedProblem:
(const std::__1::vector<std::__1::vector<double, std::__1::allocator<double> >, std::__1::allocator<std::__1::vector<double, std::__1::allocator<double> > > >) $39 = size=4 {
  [0] = size=9 {
    [0] = -0.44364916731037085
    [1] = -0.44364916731037085
    [2] = -0.44364916731037085
    [3] = -0.25
    [4] = -0.25
    [5] = -0.25
    [6] = -0.056350832689629149
    [7] = -0.056350832689629149
    [8] = -0.056350832689629149
  }
  [1] = size=9 {
    [0] = 0.44364916731037085
    [1] = 0.44364916731037085
    [2] = 0.44364916731037085
    [3] = 0.25
    [4] = 0.25
    [5] = 0.25
    [6] = 0.056350832689629149
    [7] = 0.056350832689629149
    [8] = 0.056350832689629149
  }
  [2] = size=9 {
    [0] = 0.056350832689629149
    [1] = 0.056350832689629149
    [2] = 0.056350832689629149
    [3] = 0.25
    [4] = 0.25
    [5] = 0.25
    [6] = 0.44364916731037085
    [7] = 0.44364916731037085
    [8] = 0.44364916731037085
  }
  [3] = size=9 {
    [0] = -0.056350832689629149
    [1] = -0.056350832689629149
    [2] = -0.056350832689629149
    [3] = -0.25
    [4] = -0.25
    [5] = -0.25
    [6] = -0.44364916731037085
    [7] = -0.44364916731037085
    [8] = -0.44364916731037085
  }
}
(lldb) p dxidx_map
(const std::__1::vector<double, std::__1::allocator<double> >) $40 = size=9 {
  [0] = 1.9232041958002115
  [1] = 2.1114438025048119
  [2] = 2.2769943633373768
  [3] = 2.0495859891289729
  [4] = 1.9959721683373919
  [5] = 1.9472431630683176
  [6] = 1.8435822380293627
  [7] = 2.0122564820855757
  [8] = 2.2385157210870226
}

# 1/9/19

`2d-one-spot-scaled-2nd-order.i` 24 steps with surface tension with dt = 0.5:
FDP:
non-linear: 109
average: 4.54

SMP:
non-linear: 102
average = 4.25

with more refinement:
SMP:
time step 19
time = 8.66406
dt = .0234375
nl = 112
